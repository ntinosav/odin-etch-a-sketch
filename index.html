<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Etch-A-Sketch</title>
</head>
<body>

    <button id="size">Change Size</button>
    <div id="grid"></div>


    <script>
        const grid = document.getElementById("grid");
        const sizeButton = document.querySelector("#size");

        function createGrid(n) {
            grid.innerHTML = "";
            let dim = 100/n;
            for (let i = 0; i < n ;i++) {
                let row = document.createElement("div");
                row.classList.add("row");
                row.style.height = dim + "%";
                grid.appendChild(row);
                for (let j = 0; j < n; j++) {
                    let square = document.createElement("div");
                    square.classList.add("square");
                    square.style.width = dim + "%";
                    row.appendChild(square);
                }    
            }

            // Make squares clickable
            let squares = document.querySelectorAll(".square");
            squares.forEach((sq) => {
                sq.addEventListener("click", () => {
                    if (sq.classList.contains("clicked")) {
                        let col = sq.style.backgroundColor;
                        if (sq.classList.contains("darkest")) {
                            var op = col.substring(col.length-2, col.length-1);
                            console.log("Op now is :" + op);
                            sq.classList.remove("darkest"); 
                        }else{
                            var op = col.substring(col.length-4, col.length-1);
                        }
                        console.log(op);
                        op = parseFloat(op);
                        op = op + 0.1;
                        
                        op = Math.round(op*10)/10;
                        console.log("Outside if " + op);
                        if (op <= 1) {
                            // op = op + 0.1;
                            // op = Math.round(op*10)/10;
                            console.log(op);
                            col = col.substring(0, col.length -6);
                            col = col + "," + op + ")";
                            sq.style.backgroundColor = col;
                            console.log(col);
                            if (op == 1) {
                                sq.classList.add("darkest");
                            }
                        }else{
                            op = 0.1;
                            col = col.substring(0, col.length -1);
                            col = col + "," + op + ")";
                            sq.style.backgroundColor = col;
                            console.log(col);
                        }       
                        
                    }else{
                        let red = Math.floor(Math.random()*256);
                        let green = Math.floor(Math.random()*256);
                        let blue = Math.floor(Math.random()*256);
                        let alpha = 0.1;
                        let r_color = "rgba(" + red +"," + green + "," + blue + "," + alpha + ")";
                        console.log("rgb(" + red +"," + green + "," + blue + ")");
                        sq.style.backgroundColor = r_color;
                        sq.classList.add("clicked");
                    }
                    
                });
            });

        }

        function changeSize() {
            let sq = prompt("Enter how many squares you want ? (maximum 100)");
            return sq;
        }

        sizeButton.addEventListener("click", () => createGrid(changeSize()));



        createGrid(16);
    </script>

</body>
</html>