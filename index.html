<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Etch-A-Sketch</title>
</head>
<body>

    <button id="size">Change Size</button>
    <div id="grid"></div>


    <script>
        const grid = document.getElementById("grid");
        const sizeButton = document.querySelector("#size");

        function createGrid(n) {

            createDefaultGrid(n);
            
            // Make squares clickable
            let squares = document.querySelectorAll(".square");
            squares.forEach((sq) => {
                sq.addEventListener("mouseover", () => {
                    if (sq.classList.contains("clicked")) {
                        incrementOpacity(sq);        
                    }else{  // set random color with opacity to 0.1
                        setRandomColor(sq);
                    }
                });
            });

        }




        function createDefaultGrid(n) {
            grid.innerHTML = "";
            let dim = 100/n;
            for (let i = 0; i < n ;i++) {
                let row = document.createElement("div");
                row.classList.add("row");
                row.style.height = dim + "%";
                grid.appendChild(row);
                for (let j = 0; j < n; j++) {
                    let square = document.createElement("div");
                    square.classList.add("square");
                    square.style.width = dim + "%";
                    row.appendChild(square);
                }    
            }
        }




        function setRandomColor(square) {
            let red = Math.floor(Math.random()*256);
            let green = Math.floor(Math.random()*256);
            let blue = Math.floor(Math.random()*256);
            let r_color = "rgb(" + red +"," + green + "," + blue + ")";
            console.log("rgb(" + red +"," + green + "," + blue + ")");
            square.style.backgroundColor = r_color;
            square.style.opacity = "0.1";
            square.classList.add("clicked");
        }
        

        function incrementOpacity(square) {
            let op = square.style.opacity;
            if (op == "1") {
                square.style.opacity = 0.1;
            }else{
                op = parseFloat(op);
                op = op + 0.1;
                op = Math.round(op*10)/10;
                square.style.opacity = op;
            }
        }


        function changeSize() {
            let size = 0;
            do {
                size = prompt("Enter how many squares you want ? (maximum 100)");
            }while(size < 1 || size > 100)
            
            return size;
        }


        sizeButton.addEventListener("click", () => createGrid(changeSize()));



        createGrid(16);
    </script>

</body>
</html>